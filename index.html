<!doctype html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Association Argan</title>
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <!-- Chargement de Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

</head>

<body>
    <div class="container">
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon"><img src="logo.jpg" alt="Logo Argan" style="width: 50px; height: 50px; border-radius:50%; object-fit: cover;"></div>
                <h1 id="app-title">Arg-Tifaout</h1>
            </div>
            <div class="menu-item active" data-page="dashboard"><span class="menu-icon">üìä</span> <span>Tableau de bord</span></div>
            <div class="menu-item" data-page="members"><span class="menu-icon">üë•</span> <span>Membres</span></div>
            <div class="menu-item" data-page="purchases"><span class="menu-icon">üõí</span> <span>Achats de fruits</span></div>
            <div class="menu-item" data-page="production"><span class="menu-icon">‚öôÔ∏è</span> <span>Production</span></div>
            <div class="menu-item" data-page="sales"><span class="menu-icon">üí∞</span> <span>Ventes</span></div>
            <div class="menu-item" data-page="stock"><span class="menu-icon">üì¶</span> <span>Stock</span></div>
            <div class="menu-item" data-page="accounting"><span class="menu-icon">üíµ</span> <span>Comptabilit√©</span></div>
            <div class="menu-item" data-page="settings"><span class="menu-icon">‚öôÔ∏è</span> <span>Param√®tres</span></div>
        </div>
        <div class="main-content">
            <!-- Dashboard Page -->
            <div class="page active" id="dashboard">
                <div class="header">
                    <h2 id="welcome-message" class="text-2xl font-bold text-gray-800">Bienvenue dans votre espace de
                        gestion</h2>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üå∞</div>
                        <div class="stat-label">Fruits collect√©s (kg)</div>
                        <div class="stat-value" id="total-fruits">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üõ¢Ô∏è</div>
                        <div class="stat-label">Huile produite (L)</div>
                        <div class="stat-value" id="total-oil">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-label">Chiffre d'affaires (MAD)</div>
                        <div class="stat-value" id="total-revenue-dashboard">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-label">B√©n√©fice net (MAD)</div>
                        <div class="stat-value" id="net-profit">0</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">√âvolution mensuelle (Revenus vs Achats)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Notifications r√©centes</h3>
                    </div>
                    <div id="notifications-container">
                        <p class="text-gray-500">Aucune notification en cours.</p>
                    </div>
                </div>
            </div>
            <!-- Members Page -->
            <div class="page" id="members">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Gestion des membres</h2>
                    <button class="btn btn-primary" onclick="openMemberModal()"> <span>‚ûï</span> Ajouter un membre
                    </button>
                </div>
                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" id="member-search" placeholder="Rechercher par nom ou r√¥le...">
                        <select class="form-input" id="member-role-filter" style="max-width: 200px;">
                            <option value="">Tous les r√¥les</option>
                            <option value="Pr√©sident">Pr√©sident</option>
                            <option value="Tr√©sorier">Tr√©sorier</option>
                            <option value="Secr√©taire">Secr√©taire</option>
                            <option value="Membre">Membre</option>
                            <option value="Productrice">Productrice</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>R√¥le</th>
                                    <th>T√©l√©phone</th>
                                    <th>Date d'adh√©sion</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="members-table">
                                <tr>
                                    <td colspan="5" class="text-center text-gray-500 py-4">Chargement des membres...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- Purchases Page -->
            <div class="page" id="purchases">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Achats de fruits</h2>
                    <button class="btn btn-primary" onclick="openPurchaseModal()"> <span>‚ûï</span> Nouvel achat </button>
                </div>
                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" id="purchase-search"
                            placeholder="Rechercher par fournisseur...">
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Fournisseur</th>
                                    <th>Quantit√© (kg)</th>
                                    <th>Prix/kg (MAD)</th>
                                    <th>Total (MAD)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="purchases-table">
                                <tr>
                                    <td colspan="6" class="text-center text-gray-500 py-4">Chargement des achats...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">√âvolution des achats (Montant total par mois)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="purchasesChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- Production Page -->
            <div class="page" id="production">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Production d'huile</h2>
                    <button class="btn btn-primary" onclick="openProductionModal()"> <span>‚ûï</span> Nouvelle production
                    </button>
                </div>
                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Fruits utilis√©s (kg)</th>
                                    <th>Huile produite (L)</th>
                                    <th>Rendement (%)</th>
                                    <th>Responsable</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="production-table">
                                <tr>
                                    <td colspan="6" class="text-center text-gray-500 py-4">Chargement des productions...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Rendement de production (Huile/Fruits)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="productionChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- Sales Page -->
            <div class="page" id="sales">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Ventes</h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="openSaleModal()"> <span>‚ûï</span> Nouvelle vente </button>
                        <button class="btn btn-secondary" onclick="exportSales()"> <span>üì•</span> Exporter </button>
                    </div>
                </div>
                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" id="sale-search"
                            placeholder="Rechercher par client ou facture...">
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>N¬∞ Facture</th>
                                    <th>Date</th>
                                    <th>Client</th>
                                    <th>Produit</th>
                                    <th>Quantit√©</th>
                                    <th>Prix unitaire (MAD)</th>
                                    <th>Total (MAD)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="sales-table">
                                <tr>
                                    <td colspan="8" class="text-center text-gray-500 py-4">Chargement des ventes...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- Stock Page -->
            <div class="page" id="stock">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Gestion du stock</h2>
                    <button class="btn btn-primary" onclick="openStockModal()"> <span>‚ûï</span> Ajouter un article </button>
                </div>
                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Article</th>
                                    <th>Quantit√© disponible</th>
                                    <th>Unit√©</th>
                                    <th>Seuil minimum</th>
                                    <th>√âtat</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="stock-table">
                                <tr>
                                    <td colspan="6" class="text-center text-gray-500 py-4">Chargement du stock...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- Accounting Page -->
            <div class="page" id="accounting">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Comptabilit√©</h2>
                    <button class="btn btn-primary" onclick="openAccountingModal()"> <span>‚ûï</span> Nouvelle op√©ration
                    </button>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üíµ</div>
                        <div class="stat-label">Revenus totaux (MAD)</div>
                        <div class="stat-value" id="total-revenue">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∏</div>
                        <div class="stat-label">D√©penses totales (MAD)</div>
                        <div class="stat-value" id="total-expenses">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-label">Solde actuel (MAD)</div>
                        <div class="stat-value" id="current-balance">0</div>
                    </div>
                </div>
                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" id="accounting-search"
                            placeholder="Rechercher une op√©ration...">
                        <select class="form-input" id="accounting-filter" style="max-width: 200px;">
                            <option value="">Toutes les cat√©gories</option>
                            <option value="Vente">Vente (Revenu)</option>
                            <option value="Achat">Achat (D√©pense)</option>
                            <option value="Autre D√©pense">Autre D√©pense</option>
                            <option value="Autre Revenu">Autre Revenu</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Cat√©gorie</th>
                                    <th>Description</th>
                                    <th>Montant (MAD)</th>
                                    <th>Type</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="accounting-table">
                                <tr>
                                    <td colspan="6" class="text-center text-gray-500 py-4">Chargement des op√©rations...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Revenus vs D√©penses (Annuel)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="accountingChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- Settings Page -->
            <div class="page" id="settings">
                <div class="header">
                    <h2 class="text-2xl font-bold text-gray-800">Param√®tres</h2>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Utilisateur et connexion</h3>
                    </div>
                    <p class="mb-4 text-sm text-gray-600">ID Utilisateur Actuel: <code id="current-user-id"
                            class="font-mono text-xs text-primary-color">Chargement...</code></p>
                    <div class="form-group"><label class="form-label" for="app-id-display">ID de l'Application</label>
                        <input type="text" class="form-input bg-gray-100 cursor-not-allowed" id="app-id-display"
                            readonly>
                    </div>
                    <div class="form-group"><label class="form-label" for="language-select">Langue</label>
                        <select class="form-input" id="language-select">
                            <option value="fr">Fran√ßais</option>
                            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                    <div class="form-group"><label class="form-label" for="currency-select">Devise</label>
                        <select class="form-input" id="currency-select">
                            <option value="MAD">Dirham marocain (MAD)</option>
                            <option value="EUR">Euro (EUR)</option>
                            <option value="USD">Dollar am√©ricain (USD)</option>
                        </select>
                    </div>
                    <button class="btn btn-success" onclick="saveSettings()"> <span>üíæ</span> Enregistrer les
                        modifications </button>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Informations de l'association</h3>
                    </div>
                    <p class="text-sm text-gray-500">Ces informations sont partag√©es globalement.</p>
                    <div class="form-group"><label class="form-label" for="association-name">Nom de l'association</label>
                        <input type="text" class="form-input" id="association-name">
                    </div>
                    <div class="form-group"><label class="form-label" for="association-phone">T√©l√©phone</label>
                        <input type="tel" class="form-input" id="association-phone">
                    </div>
                    <div class="form-group"><label class="form-label" for="association-address">Adresse</label>
                        <input type="text" class="form-input" id="association-address">
                    </div>
                    <button class="btn btn-success" onclick="saveGlobalSettings()"> <span>üíæ</span> Enregistrer les
                        informations globales </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- Member Modal -->
    <div class="modal" id="member-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="member-modal-title">Ajouter un membre</h3>
            </div>
            <form id="member-form" onsubmit="saveMember(event)">
                <input type="hidden" id="member-id">
                <div class="form-group"><label class="form-label" for="member-name">Nom complet</label>
                    <input type="text" class="form-input" id="member-name" required>
                </div>
                <div class="form-group"><label class="form-label" for="member-role">R√¥le</label>
                    <select class="form-input" id="member-role" required>
                        <option value="">S√©lectionner un r√¥le</option>
                        <option value="Pr√©sident">Pr√©sident</option>
                        <option value="Tr√©sorier">Tr√©sorier</option>
                        <option value="Secr√©taire">Secr√©taire</option>
                        <option value="Membre">Membre</option>
                        <option value="Productrice">Productrice</option>
                    </select>
                </div>
                <div class="form-group"><label class="form-label" for="member-phone">T√©l√©phone</label>
                    <input type="tel" class="form-input" id="member-phone" required>
                </div>
                <div class="form-group"><label class="form-label" for="member-date">Date d'adh√©sion</label>
                    <input type="date" class="form-input" id="member-date" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('member-modal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Purchase Modal -->
    <div class="modal" id="purchase-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nouvel achat de fruits</h3>
            </div>
            <form id="purchase-form" onsubmit="savePurchase(event)">
                <input type="hidden" id="purchase-id">
                <div class="form-group"><label class="form-label" for="purchase-date">Date</label>
                    <input type="date" class="form-input" id="purchase-date" required>
                </div>
                <div class="form-group"><label class="form-label" for="purchase-supplier">Fournisseur</label>
                    <input type="text" class="form-input" id="purchase-supplier" required>
                </div>
                <div class="form-group"><label class="form-label" for="purchase-quantity">Quantit√© (kg)</label>
                    <input type="number" class="form-input" id="purchase-quantity" step="0.01" required min="0.01">
                </div>
                <div class="form-group"><label class="form-label" for="purchase-price">Prix par kg (MAD)</label>
                    <input type="number" class="form-input" id="purchase-price" step="0.01" required min="0.01">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary"
                        onclick="closeModal('purchase-modal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Production Modal -->
    <div class="modal" id="production-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nouvelle production</h3>
            </div>
            <form id="production-form" onsubmit="saveProduction(event)">
                <input type="hidden" id="production-id">
                <div class="form-group"><label class="form-label" for="production-date">Date</label>
                    <input type="date" class="form-input" id="production-date" required>
                </div>
                <div class="form-group"><label class="form-label" for="production-fruits">Fruits utilis√©s (kg)</label>
                    <input type="number" class="form-input" id="production-fruits" step="0.01" required min="0">
                    <p class="text-xs text-gray-500 mt-1">Stock de fruits actuel: <span
                            id="fruit-stock-info">0</span> kg</p>
                </div>
                <div class="form-group"><label class="form-label" for="production-oil">Huile produite (L)</label>
                    <input type="number" class="form-input" id="production-oil" step="0.01" required min="0.01">
                </div>
                <div class="form-group"><label class="form-label" for="production-responsible">Responsable</label>
                    <input type="text" class="form-input" id="production-responsible" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary"
                        onclick="closeModal('production-modal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sale Modal -->
    <div class="modal" id="sale-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nouvelle vente</h3>
            </div>
            <form id="sale-form" onsubmit="saveSale(event)">
                <input type="hidden" id="sale-id">
                <div class="form-group"><label class="form-label" for="sale-invoice">N¬∞ Facture</label>
                    <input type="text" class="form-input" id="sale-invoice" required>
                </div>
                <div class="form-group"><label class="form-label" for="sale-date">Date</label>
                    <input type="date" class="form-input" id="sale-date" required>
                </div>
                <div class="form-group"><label class="form-label" for="sale-client">Client</label>
                    <input type="text" class="form-input" id="sale-client" required>
                </div>
                <div class="form-group"><label class="form-label" for="sale-product">Produit</label>
                    <select class="form-input" id="sale-product" required>
                        <option value="Huile d'Argan (Alimentaire)">Huile d'Argan (Alimentaire)</option>
                        <option value="Huile d'Argan (Cosm√©tique)">Huile d'Argan (Cosm√©tique)</option>
                        <option value="Amandes d'Argan">Amandes d'Argan</option>
                        <option value="Autres">Autres</option>
                    </select>
                </div>
                <div class="form-group"><label class="form-label" for="sale-quantity">Quantit√©</label>
                    <input type="number" class="form-input" id="sale-quantity" step="0.01" required min="0.01">
                    <p class="text-xs text-gray-500 mt-1">Quantit√© en stock: <span id="oil-stock-info">0</span> L
                        (Huile)</p>
                </div>
                <div class="form-group"><label class="form-label" for="sale-unit-price">Prix unitaire (MAD)</label>
                    <input type="number" class="form-input" id="sale-unit-price" step="0.01" required min="0.01">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('sale-modal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Stock Modal -->
    <div class="modal" id="stock-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="stock-modal-title">Ajouter/Modifier un article en stock</h3>
            </div>
            <form id="stock-form" onsubmit="saveStock(event)">
                <input type="hidden" id="stock-id">
                <div class="form-group"><label class="form-label" for="stock-item">Article</label>
                    <input type="text" class="form-input" id="stock-item" required>
                </div>
                <div class="form-group"><label class="form-label" for="stock-available">Quantit√© disponible</label>
                    <input type="number" class="form-input" id="stock-available" step="0.01" required min="0">
                </div>
                <div class="form-group"><label class="form-label" for="stock-unit">Unit√©</label>
                    <select class="form-input" id="stock-unit" required>
                        <option value="kg">Kilogrammes (kg)</option>
                        <option value="L">Litres (L)</option>
                        <option value="unit√©">Unit√©</option>
                    </select>
                </div>
                <div class="form-group"><label class="form-label" for="stock-minimum">Seuil minimum</label>
                    <input type="number" class="form-input" id="stock-minimum" step="0.01" required min="0">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('stock-modal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Accounting Modal -->
    <div class="modal" id="accounting-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nouvelle op√©ration</h3>
            </div>
            <form id="accounting-form" onsubmit="saveAccounting(event)">
                <input type="hidden" id="accounting-id">
                <div class="form-group"><label class="form-label" for="accounting-date">Date</label>
                    <input type="date" class="form-input" id="accounting-date" required>
                </div>
                <div class="form-group"><label class="form-label" for="accounting-category">Cat√©gorie</label>
                    <select class="form-input" id="accounting-category" required>
                        <option value="">S√©lectionner une cat√©gorie</option>
                        <option value="Vente">Vente (Revenu)</option>
                        <option value="Achat">Achat (D√©pense)</option>
                        <option value="Salaire/R√©mun√©ration">Salaire/R√©mun√©ration (D√©pense)</option>
                        <option value="Frais de fonctionnement">Frais de fonctionnement (D√©pense)</option>
                        <option value="Subvention">Subvention (Revenu)</option>
                        <option value="Autre D√©pense">Autre D√©pense</option>
                        <option value="Autre Revenu">Autre Revenu</option>
                    </select>
                </div>
                <div class="form-group"><label class="form-label" for="accounting-description">Description</label>
                    <input type="text" class="form-input" id="accounting-description" required>
                </div>
                <div class="form-group"><label class="form-label" for="accounting-amount">Montant (MAD)</label>
                    <input type="number" class="form-input" id="accounting-amount" step="0.01" required min="0.01">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary"
                        onclick="closeModal('accounting-modal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Custom Message Box for Alert/Confirm -->
    <div class="modal" id="message-box-modal">
        <div class="modal-content">
            <h3 class="modal-title" id="message-box-title">Message</h3>
            <p id="message-box-text" class="my-4"></p>
            <div class="form-actions" id="message-box-actions">
                <!-- Buttons are added by JS -->
            </div>
        </div>
    </div>

    <script type="module" src="script.js"></script>

</body>

</html>